#!/usr/bin/env bash

if [ -z "$1" -o -z "$2" ]; then
  echo "Please provide first and second currency."
  echo "e.g. $0 CAD USD [amount]"
  exit 1
fi

Akey="1a09efb5f6fe4ec6b5f3"
currency1=`echo -n $1 | tr '[:lower:]' '[:upper:]'`
currency2=`echo -n $2 | tr '[:lower:]' '[:upper:]'`
sym1=$(jq ".${currency1}.symbol" ~/bin/currencies.json)
sym2=$(jq ".${currency2}.symbol" ~/bin/currencies.json)

unit_price_f=$(curl -s "https://free.currconv.com/api/v7/convert?q=${currency1}_${currency2}&compact=ultra&apiKey=${Akey}" | jq ".${currency1}_${currency2}")

unit_price=$(printf "%.2f"  $unit_price_f)

# echo  $currency1 from $currency2 is  $unit_price.

echo  "$sym1 $unit_price $sym2"|sed 's/\"//g'

if [ ! -z "$3" ]; then
  echo
  echo -n "$3 $1 is "
  echo "$3 * $unit_price" | bc -l | tr -d "\n"
  echo " $2"
fi
# vim: ft=sh
